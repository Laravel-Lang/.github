on:
    workflow_call:

permissions:
  pull-requests: write

jobs:
    check:
        runs-on: ubuntu-latest

        name: Accept

        steps:
            - uses: thehanimo/pr-title-checker@v1.4.3
              id: check
              continue-on-error: true
              with:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                pass_on_octokit_error: false
                github_configuration_owner: Laravel-Lang
                github_configuration_repo: .github
                github_configuration_path: .github/title-checker.json
                github_configuration_ref: main
      
            - name: Add comment to fix PR title
              uses: marocchino/sticky-pull-request-comment@v2
              if: ${{ steps.check.outputs.success == 'false'}}
              with:
                header: 'PR Title Check'
                recreate: true
                message: |
                    ### ðŸš¨ PR Title Needs Formatting
                    The title of this PR needs to be formatted correctly. 
                    Please update the title to match the [format](https://laravel-lang.com/contributions.html#pr_title) `[locale]: Description`.
                    Examples:
                    * `[fr]: Missing keys translated`
                    * `[de, de_DE]: Missing keys translated`

            - name: Add comment that PR title is fixed
              if: ${{ steps.check.outputs.success == 'true'}}
              uses: marocchino/sticky-pull-request-comment@v2
              with:
                header: 'PR Title Check'
                recreate: true
                message: |
                    ### âœ… PR Title Formatted Correctly
                    The title of this PR has been updated to match the correct format. Thank you!
